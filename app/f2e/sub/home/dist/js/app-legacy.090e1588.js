(function(e){function r(r){for(var t,o,a=r[0],u=r[1],c=r[2],f=0,l=[];f<a.length;f++)o=a[f],i[o]&&l.push(i[o][0]),i[o]=0;for(t in u)Object.prototype.hasOwnProperty.call(u,t)&&(e[t]=u[t]);p&&p(r);while(l.length)l.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,r=0;r<s.length;r++){for(var n=s[r],t=!0,a=1;a<n.length;a++){var u=n[a];0!==i[u]&&(t=!1)}t&&(s.splice(r--,1),e=o(o.s=n[0]))}return e}var t={},i={app:0},s=[];function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,r,n){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var t in e)o.d(n,t,function(r){return e[r]}.bind(null,t));return n},o.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="/sub/home/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=r,a=a.slice();for(var c=0;c<a.length;c++)r(a[c]);var p=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,r,n){e.exports=n("56d7")},"106f":function(e,r,n){},"21bb":function(e,r,n){"use strict";var t=n("8776"),i=n.n(t);i.a},"56d7":function(e,r,n){"use strict";n.r(r);n("cadf"),n("551c"),n("097d"),n("d1e7"),n("bf40");var t=n("2b0e"),i=n("ce5b"),s=n.n(i),o=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("v-app",[n("v-toolbar",{staticClass:"blue",attrs:{app:"",light:"",fixed:!0}},[n("v-toolbar-side-icon",{attrs:{light:""}}),n("v-toolbar-title",{staticClass:"white--text"},[e._v("www.picoluna.com")]),n("v-spacer"),n("v-toolbar-items")],1),n("v-content",[n("v-container",{attrs:{fluid:""}},[n("router-view")],1)],1)],1)},a=[],u=(n("5c0b"),n("2877")),c={},p=Object(u["a"])(c,o,a,!1,null,null,null),f=p.exports,l=n("8c4f"),b=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("div",{staticClass:"page-home"},[e.permission&&"granted"!==e.permission||!1===e.haveSubscription?n("v-btn",{attrs:{color:"info"},nativeOn:{click:function(r){return e.requestPermission(r)}}},[e._v("Subscript notifications\n  ")]):e._e(),"granted"===e.permission&&!0===e.haveSubscription?n("v-btn",{attrs:{color:"info"},nativeOn:{click:function(r){return e.unsubscribe(r)}}},[e._v("Unsubscribe notifications\n  ")]):e._e()],1)},h=[],v=n("8afe"),d=(n("34ef"),n("a481"),n("14b9"),n("96cf"),n("3040")),g={name:"home",components:{},data:function(){return{permission:"",haveSubscription:null}},mounted:function(){this.checkPermission(),this.checkSubscription(),this.autoSubscribe()},methods:{checkPermission:function(){"Notification"in window&&(this.permission=window.Notification.permission)},checkSubscription:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("serviceWorker"in navigator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.serviceWorker.ready;case 4:return r=e.sent,e.next=7,r.pushManager.getSubscription();case 7:n=e.sent,this.haveSubscription=!!n;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),autoSubscribe:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var r,n,t,i,s,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("Notification"in window&&"serviceWorker"in navigator){e.next=2;break}return e.abrupt("return");case 2:if(r=window.Notification.permission,"granted"===r){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,navigator.serviceWorker.ready;case 7:if(n=e.sent,n){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,n.pushManager.getSubscription();case 12:if(t=e.sent,!t||!t.endpoint){e.next=15;break}return e.abrupt("return");case 15:return e.next=17,fetch("/api/v1/web_push/vapid/");case 17:return i=e.sent,e.next=20,i.json();case 20:return s=e.sent,e.next=23,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(s.data.publicKey)});case 23:return t=e.sent,e.next=26,fetch("/api/v1/web_push/subscription/",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({subscription:t})});case 26:return o=e.sent,e.next=29,o.json();case 29:a=e.sent,"success"!==a.status&&console.error("subscribe error.");case 31:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),requestPermission:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var r,n,t,i,s,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("Notification"in window&&"serviceWorker"in navigator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,window.Notification.requestPermission();case 4:if(r=e.sent,this.permission=r,console.log("Permission: ".concat(r)),"granted"===r){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,navigator.serviceWorker.ready;case 11:return n=e.sent,e.next=14,n.pushManager.getSubscription();case 14:if(t=e.sent,t&&t.endpoint){e.next=25;break}return e.next=18,fetch("/api/v1/web_push/vapid/");case 18:return i=e.sent,e.next=21,i.json();case 21:return s=e.sent,e.next=24,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(s.data.publicKey)});case 24:t=e.sent;case 25:return e.next=27,fetch("/api/v1/web_push/subscription/",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({subscription:t})});case 27:return o=e.sent,e.next=30,o.json();case 30:a=e.sent,"success"!==a.status&&console.error("subscribe error.");case 32:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),unsubscribe:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var r,n,t,i,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("serviceWorker"in navigator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.serviceWorker.ready;case 4:return r=e.sent,e.next=7,r.pushManager.getSubscription();case 7:if(n=e.sent,n){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,n.unsubscribe();case 12:if(t=e.sent,t){e.next=16;break}return console.log("Failed"),e.abrupt("return");case 16:return e.next=18,fetch("/api/v1/web_push/subscription/",{headers:{"Content-Type":"application/json"},method:"DELETE",body:JSON.stringify({subscription:n})});case 18:return i=e.sent,e.next=21,i.json();case 21:s=e.sent,"success"!==s.status&&console.error("unsubscribe error.");case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),urlBase64ToUint8Array:function(e){var r="=".repeat((4-e.length%4)%4),n=(e+r).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(n);return Uint8Array.from(Object(v["a"])(t).map(function(e){return e.charCodeAt(0)}))}}},m=g,w=(n("21bb"),Object(u["a"])(m,b,h,!1,null,null,null)),x=w.exports;t["default"].use(l["a"]);var y=new l["a"]({mode:"history",base:"/",routes:[{path:"*",name:"home",component:x}]}),k=n("2f62");t["default"].use(k["a"]);var O=new k["a"].Store({state:{},mutations:{},actions:{}}),S=n("9483");Object(S["a"])("/service-worker.js",{ready:function(e){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(e){console.log("Content has been cached for offline use.")},updated:function(e){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),t["default"].config.productionTip=!1,t["default"].use(s.a),new t["default"]({router:y,store:O,render:function(e){return e(f)}}).$mount("#app")},"5c0b":function(e,r,n){"use strict";var t=n("106f"),i=n.n(t);i.a},8776:function(e,r,n){}});
//# sourceMappingURL=app-legacy.090e1588.js.map